// Generated by CoffeeScript 1.7.1
(function() {
  var delete_game, formatDate;

  formatDate = function(d) {
    var ampm, d_names, h, s;
    d = new Date(d);
    d_names = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    ampm = d.getHours() < 13 ? "am" : "pm";
    h = d.getHours() % 12;
    h = h === 0 ? 12 : h;
    return s = d_names[d.getDay()] + " " + d.getDate() + "/" + (d.getMonth() + 1) + "/" + d.getFullYear() + " " + h + ":" + d.getMinutes() + ampm;
  };

  jQuery(function() {
    var gamesReq;
    gamesReq = $.ajax({
      url: '/api?type=games&gamestate=0'
    });
    return gamesReq.done(function(res, status, jqXHR) {
      var r, _i, _len, _results;
      if (!res) {
        return;
      }
      _results = [];
      for (_i = 0, _len = res.length; _i < _len; _i++) {
        r = res[_i];
        _results.push((function(r) {
          var li;
          li = $("<a>").addClass("list-group-item").html($("<b>").text(formatDate(r.date))).append($("<br>")).append(r.name).click(function() {
            return delete_game(r.id);
          });
          $("#gamelist").append(li);
          return $("#gamelist").show();
        })(r));
      }
      return _results;
    });
  });

  delete_game = function(id) {
    var deleteReq;
    deleteReq = $.ajax({
      url: '/api?type=deletegame&id=' + id
    });
    return deleteReq.done(function(res, status, jqXHR) {
      return location.reload();
    });
  };

}).call(this);
